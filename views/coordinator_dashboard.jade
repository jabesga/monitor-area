doctype html
html
    head
        title= title
        meta(name="viewport" content="width=device-width, initial-scale=1.0")
        link(rel='stylesheet', href='//netdna.bootstrapcdn.com/bootstrap/3.0.2/css/bootstrap.min.css')
        link(rel='stylesheet', href='/stylesheets/dashboard.css')
        style.
            body{
                overflow-x: hidden;
            }
    body
        nav.navbar.navbar-inverse.navbar-fixed-top
            div.container-fluid
                div.navbar-header
                    button(type='button' class='navbar-toggle collapsed' data-toggle='collapse' data-target='#navbar' aria-expanded='false' aria-controls='navbar')
                        span.sr-only Toggle navigation
                        span.icon-bar
                        span.icon-bar
                        span.icon-bar
                    a.navbar-brand(href='#') Camptecnologico
                div.navbar-collapse.collapse(id='navbar' aria-expanded='false' style='height=1px;')
                    ul.nav.navbar-nav.navbar-right
                        li
                            a(href='#') Mi perfil
                        li
                            a(href='/logout') Logout
        div.container-fluid
            div.row
                div.col-sm-3.col-md-2.sidebar
                    ul.nav.nav-sidebar
                        li
                            a(href='#') Inicio
                            span.sr-only (current)
                    ul.nav.nav-sidebar
                        li.active
                            a(href='#') Monitores

                    ul.nav.nav-sidebar
                        li
                            a(href='#') Tecnologias
                    ul.nav.nav-sidebar
                        li
                            a(href='#') Clases
                        li
                            a(href='#') Colegios
                div.col-sm-9.col-sm-offset-3.col-md-10.col-md-offset-2.main
                    h1.page-header= title
                    h2.sub-header Monitores
                    div.modal.fade#addMonitor(role="dialog" aria-labelledby="basicModal" aria-hidden="true")
                        div.modal-dialog
                            div.modal-content
                                div.modal-header
                                    button(type="button" class="close" data-dismiss="modal" aria-hidden="true") &times;
                                    h4.modal-title Añadir monitor
                                div.modal-body
                                    form.form-horizontal(action="#" method="post" id="monitor")
                                        div.form-group
                                            label(for="inputUsername" class="sr-only") Username
                                            input(type="text" id="inputUsername" class="form-control" name="username" placeholder="Username" required autofocus)
                                        div.form-group
                                            label(for="inputUsername" class="sr-only") Password
                                            input(type="password" class="form-control" name="password" placeholder="Password" required)
                                div.modal-footer
                                    span.pull-left#status
                                    button(type="button" class="btn btn-default" data-dismiss="modal") Close                                            
                                    input(type="submit" class="btn btn-primary" value="Save changes" id="submit")       
                    div.table-responsive
                        table.table.table-striped
                            thead
                                tr
                                    th #
                                    th Nombre de usuario
                                    th Nombre
                                    th Apellido
                                    th Email
                            tbody
                                each monitor in monitors
                                    tr
                                        each key in monitor
                                            td #{key._id}
                                            td #{key.username}
                                            td #{key.name}
                                            td #{key.surname}
                                            td #{key.email}
                    if message                                     
                        div(class="alert alert-success alert-dismissible" role="alert") #{message}
                            button(type="button" class="close" data-dismiss="alert") &times;
                    button.btn-default.btn.pull-right(data-toggle="modal" data-target="#addMonitor") Añadir monitor

        script(src="/javascripts/jquery.min.js")
        script(src="/javascripts/bootstrap.min.js")
        script.
            $(document).ready(function () {
                $("input#submit").click(function(){
                    $.ajax({
                        type: "POST",
                            url: "/add-monitor",
                            data: $('form.monitor').serialize(),
                        success: function(data){
                            $("#status").html("Cambios realizados");
                            $("#addMonitor").modal('hide');
                            if(typeof data.redirect == 'string'){
                                window.location = data.redirect;
                            }
                        },
                        error: function(){
                            console.log("Fallo");
                        }
                    });
                });
                $('#addMonitor').on('shown.bs.modal', function () {
                    $("#status").html("");
                    $('#inputUsername').focus();
                });
            });
